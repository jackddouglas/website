<article>
  <h1 class="post-title">$title$</h1>
  <section class="post-content">$body$</section>
</article>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Process footnotes for responsive display
    const postContent = document.querySelector(".post-content");
    const footnotes = postContent.querySelector(".footnotes");

    if (footnotes && window.innerWidth >= 1024) {
      // Get all footnote references in this post
      const footnoteRefs = postContent.querySelectorAll("a.footnote-ref");

      // For each reference, create a sidenote
      footnoteRefs.forEach((ref) => {
        // Extract the footnote ID from the href
        const footnoteId = ref.getAttribute("href").substring(1);

        // Find the corresponding footnote content
        const footnote = footnotes.querySelector("#" + footnoteId);

        if (footnote) {
          // Create a sidenote element
          const sidenote = document.createElement("div");
          sidenote.className = "sidenote";

          // Get the footnote content (excluding the backref)
          const footnoteContent = footnote.innerHTML;

          // Remove the backref from the content
          const cleanContent = footnoteContent.replace(
            /<a class="footnote-back".*?<\/a>/,
            "",
          );

          // Set the sidenote content
          sidenote.innerHTML = cleanContent;

          // Position the sidenote at the same vertical position as the reference
          const refRect = ref.getBoundingClientRect();
          const contentRect = postContent.getBoundingClientRect();
          const topPosition = refRect.top - contentRect.top;

          sidenote.style.position = "absolute";
          sidenote.style.top = topPosition + "px";

          // Add the sidenote to the post content
          postContent.appendChild(sidenote);
        }
      });

      // Hide the original footnotes section on larger screens
      footnotes.style.display = "none";
    }
  });
</script>
